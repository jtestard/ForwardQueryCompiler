<?xml version="1.0" encoding="UTF-8"?>
<test_case>
    <query_plan>
        <SendPlan cardinality_estimate="SMALL" execution_data_source="mediator" impl="SendPlanImplInMemory">
            <arguments>
                <group_by execution_data_source="mediator" cardinality_estimate="SMALL">
                    <arguments>
                        <GroupByItem>
                            <Variable name="proposal" />
                        </GroupByItem>
                        <aggregate alias="star">
                            <function_call name="COUNT" set_quantifier="ALL" />
                        </aggregate>
                        <aggregate alias="count">
                            <function_call name="COUNT" set_quantifier="DISTINCT">
                                <Variable name="grade" />
                            </function_call>
                        </aggregate>
                        <aggregate alias="sum">
                            <function_call name="SUM" set_quantifier="DISTINCT">
                                <Variable name="grade" />
                            </function_call>
                        </aggregate>
                        <aggregate alias="avg">
                            <function_call name="AVG" set_quantifier="DISTINCT">
                                <Variable name="grade" />
                            </function_call>
                        </aggregate>
                        <aggregate alias="min">
                            <function_call name="MIN" set_quantifier="DISTINCT">
                                <Variable name="grade" />
                            </function_call>
                        </aggregate>
                        <aggregate alias="max">
                            <function_call name="MAX" set_quantifier="DISTINCT">
                                <Variable name="grade" />
                            </function_call>
                        </aggregate>
                        <aggregate alias="nest">
                            <function_call name="NEST" set_quantifier="DISTINCT">
                                <Variable name="comment" />
                                <Variable name="grade" />
                            </function_call>
                        </aggregate>
                    </arguments>
                    <SendPlan cardinality_estimate="SMALL" execution_data_source="src_1" impl="SendPlanImplIdb">
                        <arguments>
                            <Scan alias="R" execution_data_source="src_1" cardinality_estimate="SMALL">
                                <arguments>
                                    <Variable mode="ABSOLUTE" data_source="src_1" schema_object="reviews" />
                                    <Attribute>
                                        <QueryPath steps="proposal" />
                                        <Variable name="proposal" />
                                    </Attribute>
                                    <Attribute>
                                        <QueryPath steps="comment" />
                                        <Variable name="comment" />
                                    </Attribute>
                                    <Attribute>
                                        <QueryPath steps="grade" />
                                        <Variable name="grade" />
                                    </Attribute>
                                    <Attribute>
                                        <QueryPath steps="reviewer" />
                                        <Variable name="reviewer" />
                                    </Attribute>
                                </arguments>
                                <Ground execution_data_source="src_1" cardinality_estimate="SMALL" />
                            </Scan>
                        </arguments>
                    </SendPlan>
                </group_by>
            </arguments>
        </SendPlan>
    </query_plan>
    <data_source name="src_1" storage_system="INDEXEDDB">
    </data_source>
    <data_object name="reviews" execution_data_source="src_1" cardinality_estimate="SMALL">
        <schema_tree>
            <root type="collection">
                <element type="tuple">
                    <proposal type="integer" />
                    <comment type="string" />
                    <grade type="integer" />
                    <reviewer type="integer" />
                </element>
            </root>
        </schema_tree>
        <data_tree>
            <root>
                <element>
                    <proposal>2</proposal>
                    <comment>abc</comment>
                    <grade>10</grade>
                    <reviewer>2</reviewer>
                </element>
                <element>
                    <proposal>2</proposal>
                    <comment>abc</comment>
                    <grade>10</grade>
                    <reviewer>3</reviewer>
                </element>
                <element>
                    <proposal>2</proposal>
                    <comment>abc</comment>
                    <grade>6</grade>
                    <reviewer>1</reviewer>
                </element>
                <element>
                    <proposal>2</proposal>
                    <comment>abc</comment>
                    <grade null="true" />
                    <reviewer>1</reviewer>
                </element>
                <element>
                    <proposal null="true" />
                    <comment>abc</comment>
                    <grade>2</grade>
                    <reviewer>1</reviewer>
                </element>
                <element>
                    <proposal null="true" />
                    <comment>abc</comment>
                    <grade>2</grade>
                    <reviewer>1</reviewer>
                </element>
                <element>
                    <proposal null="true" />
                    <comment>abc</comment>
                    <grade>4</grade>
                    <reviewer null="true" />
                </element>
                <element>
                    <proposal null="true" />
                    <comment>abc</comment>
                    <grade null="true" />
                    <reviewer null="true" />
                </element>
            </root>
        </data_tree>
    </data_object>
    <data_object name="output" execution_data_source="output">
        <schema_tree>
            <root type="collection">
                <element type="tuple">
                    <proposal type="integer" />
                    <star type="decimal" />
                    <count type="decimal" />
                    <sum type="decimal" />
                    <avg type="decimal" />
                    <min type="decimal" />
                    <max type="decimal" />
                    <nest type="collection">
                        <element type="tuple">
                            <comment type="string" />
                            <grade type="integer" />
                        </element>
                    </nest>
                </element>
            </root>
            <constraints />
        </schema_tree>
        <data_tree>
            <root>
                <element>
                    <proposal>2</proposal>
                    <star>4</star>
                    <count>2</count>
                    <sum>16</sum>
                    <avg>8</avg>
                    <min>6</min>
                    <max>10</max>
                    <nest>
                        <element>
                            <comment>abc</comment>
                            <grade>10</grade>
                        </element>
                        <element>
                            <comment>abc</comment>
                            <grade>6</grade>
                        </element>
                        <element>
                            <comment>abc</comment>
                            <grade null="true" />
                        </element>
                    </nest>
                </element>
                <element>
                    <proposal null="true" />
                    <star>4</star>
                    <count>2</count>
                    <sum>6</sum>
                    <avg>3</avg>
                    <min>2</min>
                    <max>4</max>
                    <nest>
                        <element>
                            <comment>abc</comment>
                            <grade>2</grade>
                        </element>
                        <element>
                            <comment>abc</comment>
                            <grade>4</grade>
                        </element>
                        <element>
                            <comment>abc</comment>
                            <grade null="true" />
                        </element>
                    </nest>
                </element>
            </root>
        </data_tree>
    </data_object>
</test_case>